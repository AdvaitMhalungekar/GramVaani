<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gramvaani - Healthcare Information</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='healthcare.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
  <!-- Navbar - Same as main page -->
  <nav class="navbar">
    <div class="container nav-container">
      <div class="logo">
        <div class="logo-icon">
          <img src="{{ url_for('static', filename='assets/logo.png') }}" alt="Gramvaani Logo" class="logo-img">
        </div>
        <div class="logo-text">Gram<span class="accent">vaani</span></div>
      </div>
      <div class="header-actions">
        <div class="language-mic-wrapper">
          <div class="language-selector" onclick="toggleDropdown()">
            <i class="fas fa-globe"></i> हिन्दी <i class="fas fa-chevron-down"></i>
          </div>
          <button class="mic-navbar">
            <i class="fas fa-microphone"></i>
          </button>
        </div>
        <div class="language-dropdown" id="languageDropdown">
          <div class="dropdown-item">English</div>
          <div class="dropdown-item">हिन्दी</div>
          <div class="dropdown-item">मराठी</div>
          <div class="dropdown-item">தமிழ்</div>
          <div class="dropdown-item">বাংলা</div>
          <div class="dropdown-item">తెలుగు</div>
          <div class="dropdown-item">ગુજરાતી</div>
          <div class="dropdown-item">ଓଡ଼ିଆ</div>
          <div class="dropdown-item">ಕನ್ನಡ</div>
          <div class="dropdown-item">മലയാളം</div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Healthcare Hero Section -->
  <div class="healthcare-hero">
    <div class="container">
      <div class="breadcrumb">
        <a href="/">Home</a> <i class="fas fa-chevron-right"></i> <span>Healthcare Information</span>
      </div>
      <h1 class="healthcare-title">Healthcare Information System</h1>
    </div>
  </div>

  <div class="container main-content">
    <!-- Healthcare Alerts -->
    <div class="healthcare-alerts">
      <h2 class="section-title"><i class="fas fa-bell"></i> Health Alerts</h2>
      
      <div class="alert-card alert-high">
        <div class="alert-icon">
          <i class="fas fa-virus"></i>
        </div>
        <div class="alert-content">
          <h3 class="alert-title">Seasonal Flu Advisory</h3>
          <p class="alert-message">Seasonal flu cases are on the rise. Get vaccinated at your nearest healthcare center. Wash hands frequently and stay hydrated.</p>
          <p class="alert-time">Issued: 8:45 AM, April 16, 2025</p>
        </div>
      </div>
      
      <div class="alert-card alert-medium">
        <div class="alert-icon">
          <i class="fas fa-pills"></i>
        </div>
        <div class="alert-content">
          <h3 class="alert-title">Vaccination Drive</h3>
          <p class="alert-message">Free vaccination camp for children under 5 years at the Primary Health Center from April 20-25, 2025. Bring your child's vaccination card.</p>
          <p class="alert-time">Issued: 9:30 AM, April 14, 2025</p>
        </div>
      </div>
    </div>

    <!-- Preventive Care Section -->
    <div class="preventive-care">
      <h2 class="section-title"><i class="fas fa-shield-virus"></i> Preventive Care</h2>
      
      <div class="care-card-container">
        <div class="care-card">
          <div class="care-icon">
            <i class="fas fa-hand-holding-water"></i>
          </div>
          <h3 class="care-title">Stay Hydrated</h3>
          <p class="care-content">Drink at least 8 glasses of clean water daily. During summer, increase water intake to prevent dehydration.</p>
        </div>
        
        <div class="care-card">
          <div class="care-icon">
            <i class="fas fa-handwashing"></i>
          </div>
          <h3 class="care-title">Hand Hygiene</h3>
          <p class="care-content">Wash hands with soap for at least 20 seconds frequently, especially before meals and after using the toilet.</p>
        </div>
        
        <div class="care-card">
          <div class="care-icon">
            <i class="fas fa-carrot"></i>
          </div>
          <h3 class="care-title">Balanced Diet</h3>
          <p class="care-content">Include fruits, vegetables, and whole grains in your diet. Locally grown seasonal vegetables are most nutritious.</p>
        </div>
        
        <div class="care-card">
          <div class="care-icon">
            <i class="fas fa-walking"></i>
          </div>
          <h3 class="care-title">Regular Exercise</h3>
          <p class="care-content">Engage in at least 30 minutes of physical activity daily. Walking, yoga, or farm work all count as exercise.</p>
        </div>
      </div>
    </div>

    <div class="content-wrapper">
      <!-- Health News Section -->
      <div class="news-section">
        <h2 class="section-title"><i class="fas fa-newspaper"></i> Health News</h2>
        
        <div class="news-card">
          <div class="news-image">
            <i class="fas fa-syringe"></i>
          </div>
          <div class="news-content">
            <h3 class="news-title">New Health Center Opens in Rajpur</h3>
            <p class="news-preview">A new Primary Health Center has been inaugurated in Rajpur village, offering 24/7 emergency services and maternal care.</p>
            <p class="news-date">April 18, 2025</p>
          </div>
        </div>
        
        <div class="news-card">
          <div class="news-image">
            <i class="fas fa-lungs"></i>
          </div>
          <div class="news-content">
            <h3 class="news-title">Tuberculosis Awareness Campaign</h3>
            <p class="news-preview">Free TB screening camp to be held next week. Early detection leads to better treatment outcomes.</p>
            <p class="news-date">April 16, 2025</p>
          </div>
        </div>
        
        <div class="news-card">
          <div class="news-image">
            <i class="fas fa-baby"></i>
          </div>
          <div class="news-content">
            <h3 class="news-title">Maternal Health Initiative Launched</h3>
            <p class="news-preview">New program offers free prenatal checkups and nutrition supplements for pregnant women in rural areas.</p>
            <p class="news-date">April 15, 2025</p>
          </div>
        </div>
        
        <div class="news-card">
          <div class="news-image">
            <i class="fas fa-mosquito"></i>
          </div>
          <div class="news-content">
            <h3 class="news-title">Dengue Prevention Drive</h3>
            <p class="news-preview">Health workers conducting door-to-door awareness about mosquito-borne diseases. Free mosquito nets distribution next week.</p>
            <p class="news-date">April 14, 2025</p>
          </div>
        </div>
      </div>
      
      <!-- Health Chatbot Section -->
      <div class="chatbot-container">
        <div class="chatbot-header">
          <h2><i class="fas fa-robot"></i> Health Advisor</h2>
          <p>Get personalized health information and guidance</p>
        </div>
        
        <div class="chat-messages" id="chatMessages">
          <div class="message bot-message">
            <div class="message-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="message-content">
              Hello! I'm your health advisor. I can help you with health information, preventive care tips, and guide you to the right healthcare services. What would you like to know?
            </div>
          </div>
          
          <div class="message user-message">
            <div class="message-content">
              What should I do for fever?
            </div>
            <div class="message-avatar">
              <i class="fas fa-user"></i>
            </div>
          </div>
          
          <div class="message bot-message">
            <div class="message-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="message-content">
              For fever, rest and drink plenty of fluids. Take paracetamol if your temperature is above 38°C (100.4°F). If fever persists for more than 3 days or is accompanied by severe symptoms, please visit your nearest healthcare facility.
            </div>
          </div>
        </div>
        
        <div class="chat-input">
          <button id="micButton" title="Speak your question">
            <i class="fas fa-microphone"></i>
          </button>
          <input type="text" id="userMessage" placeholder="Ask about health issues, symptoms, or medicines...">
          <button id="sendMessage">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
        
        <div class="quick-questions">
          <div class="quick-question-btn">Where's the nearest doctor?</div>
          <div class="quick-question-btn">Common cold remedies</div>
          <div class="quick-question-btn">When to vaccinate my child?</div>
        </div>
      </div>
    </div>

    <!-- Nearby Hospitals Map Section -->
    <div class="map-section">
      <h2 class="section-title"><i class="fas fa-map-marked-alt"></i> Nearby Healthcare Facilities</h2>
      <div class="map-container">
        <div id="map"></div>
        <div class="map-legend">
          <div class="legend-item">
            <div class="legend-marker hospital-marker"></div>
            <span>Hospital</span>
          </div>
          <div class="legend-item">
            <div class="legend-marker clinic-marker"></div>
            <span>Clinic</span>
          </div>
          <div class="legend-item">
            <div class="legend-marker pharmacy-marker"></div>
            <span>Pharmacy</span>
          </div>
          <div class="legend-item">
            <div class="legend-marker you-marker"></div>
            <span>Your Location</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Health Services Section -->
    <div class="health-services">
      <h2 class="section-title"><i class="fas fa-briefcase-medical"></i> Health Services</h2>
      
      <div class="services-container">
        <div class="service-card">
          <div class="service-icon">
            <i class="fas fa-stethoscope"></i>
          </div>
          <div class="service-content">
            <h3 class="service-title">Primary Health Center</h3>
            <p class="service-description">Basic healthcare services including vaccinations, maternal care, and treatment of common illnesses.</p>
            <div class="service-details">
              <div class="detail-item">
                <i class="fas fa-clock"></i>
                <span>9:00 AM - 5:00 PM</span>
              </div>
              <div class="detail-item">
                <i class="fas fa-phone"></i>
                <span>1800-123-4567</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="service-card">
          <div class="service-icon">
            <i class="fas fa-ambulance"></i>
          </div>
          <div class="service-content">
            <h3 class="service-title">Emergency Services</h3>
            <p class="service-description">24/7 emergency medical services. Ambulance available for transportation to district hospital.</p>
            <div class="service-details">
              <div class="detail-item">
                <i class="fas fa-clock"></i>
                <span>24 Hours</span>
              </div>
              <div class="detail-item">
                <i class="fas fa-phone"></i>
                <span>108</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="service-card">
          <div class="service-icon">
            <i class="fas fa-baby"></i>
          </div>
          <div class="service-content">
            <h3 class="service-title">Maternal & Child Health</h3>
            <p class="service-description">Prenatal care, delivery services, and pediatric care for children up to 5 years of age.</p>
            <div class="service-details">
              <div class="detail-item">
                <i class="fas fa-clock"></i>
                <span>9:00 AM - 4:00 PM</span>
              </div>
              <div class="detail-item">
                <i class="fas fa-phone"></i>
                <span>1800-123-5678</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="service-card">
          <div class="service-icon">
            <i class="fas fa-capsules"></i>
          </div>
          <div class="service-content">
            <h3 class="service-title">Pharmacy Services</h3>
            <p class="service-description">Free essential medicines available at government health centers. Generic medicines at affordable prices.</p>
            <div class="service-details">
              <div class="detail-item">
                <i class="fas fa-clock"></i>
                <span>9:00 AM - 6:00 PM</span>
              </div>
              <div class="detail-item">
                <i class="fas fa-phone"></i>
                <span>1800-123-6789</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer - Same as main page -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-logo">
          <img src="{{ url_for('static', filename='assets/logo.png') }}" alt="Gramvaani Logo" class="footer-logo-img">
          <span>Gramvaani</span>
        </div>
        <p class="footer-tagline">Voice of the Village</p>
      </div>
      <div class="footer-links">
        <a href="#">About Us</a>
        <a href="#">Privacy Policy</a>
        <a href="#">Contact</a>
        <a href="#">Help</a>
      </div>
    </div>
  </footer>

  <div class="mic-button">
    <div class="pulse-ring"></div>
    <div class="mic-icon">
      <i class="fas fa-microphone"></i>
    </div>
    <div class="mic-tooltip">Tap to speak</div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Language dropdown toggle
    function toggleDropdown() {
      const dropdown = document.getElementById('languageDropdown');
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }

    window.addEventListener('click', function (e) {
      const langSelector = document.querySelector('.language-selector');
      const dropdown = document.getElementById('languageDropdown');
      if (!langSelector.contains(e.target)) {
        dropdown.style.display = 'none';
      }
    });

    // Initialize map
    const map = L.map('map').setView([21.7679, 78.8718], 5); // Default center of India

    // Add OpenStreetMap tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Custom marker icons
    const hospitalIcon = L.divIcon({
      className: 'custom-marker hospital-icon',
      html: '<i class="fas fa-hospital"></i>',
      iconSize: [30, 30]
    });

    const clinicIcon = L.divIcon({
      className: 'custom-marker clinic-icon',
      html: '<i class="fas fa-clinic-medical"></i>',
      iconSize: [30, 30]
    });

    const pharmacyIcon = L.divIcon({
      className: 'custom-marker pharmacy-icon',
      html: '<i class="fas fa-prescription-bottle-alt"></i>',
      iconSize: [30, 30]
    });

    const userIcon = L.divIcon({
      className: 'custom-marker user-icon',
      html: '<i class="fas fa-user-circle"></i>',
      iconSize: [30, 30]
    });

    // Try to get user's location
    map.locate({setView: true, maxZoom: 13});

    // When location is found
    map.on('locationfound', function(e) {
      const userLat = e.latitude;
      const userLon = e.longitude;

      L.marker([userLat, userLon], {icon: userIcon}).addTo(map)
        .bindPopup("You are here").openPopup();

      // Example data for nearby healthcare facilities
      // In a real application, this would come from your backend
      const healthcareFacilities = [
        {name: "District Hospital", type: "hospital", lat: userLat + 0.02, lon: userLon + 0.01},
        {name: "Primary Health Center", type: "clinic", lat: userLat - 0.01, lon: userLon + 0.02},
        {name: "Government Pharmacy", type: "pharmacy", lat: userLat + 0.01, lon: userLon - 0.01},
        {name: "Private Hospital", type: "hospital", lat: userLat - 0.02, lon: userLon - 0.02},
        {name: "Village Clinic", type: "clinic", lat: userLat + 0.03, lon: userLon - 0.03}
      ];

      // Add markers for healthcare facilities
      healthcareFacilities.forEach(facility => {
        let icon;
        switch(facility.type) {
          case 'hospital':
            icon = hospitalIcon;
            break;
          case 'clinic':
            icon = clinicIcon;
            break;
          case 'pharmacy':
            icon = pharmacyIcon;
            break;
          default:
            icon = clinicIcon;
        }
        
        L.marker([facility.lat, facility.lon], {icon: icon}).addTo(map)
          .bindPopup(`<b>${facility.name}</b><br>${facility.type.charAt(0).toUpperCase() + facility.type.slice(1)}`);
      });

      // In a real implementation, fetch from backend
      /* 
      fetch('/nearby_healthcare_facilities', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({lat: userLat, lon: userLon})
      })
      .then(response => response.json())
      .then(data => {
        data.forEach(item => {
          let icon;
          switch(item.type) {
            case 'hospital': icon = hospitalIcon; break;
            case 'clinic': icon = clinicIcon; break;
            case 'pharmacy': icon = pharmacyIcon; break;
            default: icon = clinicIcon;
          }
          
          L.marker([item.lat, item.lon], {icon: icon}).addTo(map)
            .bindPopup(`<b>${item.name}</b><br>${item.type}`);
        });
      });
      */
    });

    // On location error
    map.on('locationerror', function() {
      alert("Could not detect your location. Showing default map view.");
      
      // Sample data for demonstration
      const sampleFacilities = [
        {name: "District Hospital", type: "hospital", lat: 21.7679, lon: 78.8718},
        {name: "Primary Health Center", type: "clinic", lat: 21.7779, lon: 78.8818},
        {name: "Government Pharmacy", type: "pharmacy", lat: 21.7579, lon: 78.8618}
      ];
      
      sampleFacilities.forEach(facility => {
        let icon;
        switch(facility.type) {
          case 'hospital': icon = hospitalIcon; break;
          case 'clinic': icon = clinicIcon; break;
          case 'pharmacy': icon = pharmacyIcon; break;
          default: icon = clinicIcon;
        }
        
        L.marker([facility.lat, facility.lon], {icon: icon}).addTo(map)
          .bindPopup(`<b>${facility.name}</b><br>${facility.type.charAt(0).toUpperCase() + facility.type.slice(1)}`);
      });
    });

    // Simple chatbot functionality
    document.getElementById('sendMessage').addEventListener('click', function() {
      sendMessage();
    });

    document.getElementById('userMessage').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

    // Quick question buttons
    const quickQuestions = document.querySelectorAll('.quick-question-btn');
    quickQuestions.forEach(button => {
      button.addEventListener('click', function() {
        const question = this.textContent;
        document.getElementById('userMessage').value = question;
        sendMessage();
      });
    });

    function sendMessage() {
      const userInput = document.getElementById('userMessage');
      const message = userInput.value.trim();
      
      if (message) {
        // Add user message
        addMessage(message, 'user');
        
        // Clear input
        userInput.value = '';
        
        // Health chatbot responses
        setTimeout(() => {
          const botResponses = {
            "Where's the nearest doctor?": "Based on your location, the nearest doctor is at the Primary Health Center, about 2 km from here. It's open until 5 PM today. You can also see it on the map below.",
            "Common cold remedies": "For common cold, rest and drink plenty of warm fluids. Gargling with warm salt water can help with a sore throat. If symptoms persist for more than a week, please consult a doctor.",
            "When to vaccinate my child?": "The vaccination schedule for children includes BCG at birth, OPV and DPT at 6, 10, and 14 weeks, and Measles at 9 months. Visit your nearest health center with your child's vaccination card for more information."
          };
          
          let botReply = botResponses[message] || "I'll need to check with our healthcare database for that information. In general, for any serious health concerns, please visit your nearest healthcare facility or call the emergency number 108.";
          
          addMessage(botReply, 'bot');
        }, 1000);
      }
    }

    function addMessage(text, sender) {
      const chatMessages = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender}-message`;
      
      if (sender === 'bot') {
        messageDiv.innerHTML = `
          <div class="message-avatar">
            <i class="fas fa-robot"></i>
          </div>
          <div class="message-content">
            ${text}
          </div>
        `;
      } else {
        messageDiv.innerHTML = `
          <div class="message-content">
            ${text}
          </div>
          <div class="message-avatar">
            <i class="fas fa-user"></i>
          </div>
        `;
      }
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
  </script>
</body>
</html>